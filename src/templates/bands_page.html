{% extends "ralaot.html" %}
{% block content %}
<br><br><br><br><br>
<div class="center_user_html">
    <h3>ADD BANDS</h3>
    <form method="POST" action="/manage_bands/add">
        <legend class="border-bottom mb-4">Name</legend>
        <div class="form-group">
            {{ form.band_name }}
        </div>
        <legend class="border-bottom mb-4">Logo</legend>
        <div class="form-group">
            {{ form.band_logo }}
        </div>
        <legend class="border-bottom mb-4">Scores</legend>
        <div class="form-group">
            {{ form.band_scores }}
        </div>
        <legend class="border-bottom mb-4">Genre</legend>
        <div class="form-group">
            {{ form.band_genre }}
        </div>


        <legend class="border-bottom mb-4">Tags</legend>
        <div class="input-categories">
            <ul id='list'>

            </ul>
            <input id='custom-input' type="text" value="" data-role="tagsinput"></input>
            <br>
            <div>
                <button type="button" class="submit_delete_button" onclick='testfunc(this.e,false)'>submit</button>
                <button type="button" class="submit_delete_button" onclick='testfunc(this.e,true)'>delete</button>
            </div>
        </div>



        <button type="submit" formmethod="POST">Add band</button>
    </form>
    <br>
    <hr>
    <input class="form-control" id="myInput" type="text" placeholder="Search..">
    <br>
    <table id="customers" class="table table-bordered table-striped">
        <thead>
            <tr>
                <th>BAND NAME</th>
                <th>BAND SCORES</th>
                <th>BAND GENRE</th>
                <th>TAGS</th>
                <th>EDIT</th>
            </tr>
        </thead>

        {% for band in bands %}
        <tbody id="myTable">
            <tr>
                <td>{{ band.name }}</td>
                <td>{{ band.scores }}</td>
                <td>{{ band.genre }}</td>
                <td> {{ band.tags }}</td>
                <td>
                    <button type="button">Delete band</button>
                </td>
            </tr>

        </tbody>
        {% endfor %}
    </table>




</div>
<script>
    function testfunc(e, a) {


        if (a) {



            document.querySelector('#list').removeChild(document.querySelector('#custom-input').value)
            document.querySelector('#custom-input').value = ''
            e.preventDefault()
        } else {

            let value = document.querySelector('#custom-input').value

            const children = [...document.querySelector('#list').children]
            const childrenStrings = children.map(el => el.innerText)
            if (childrenStrings.includes(value) || !value.trim()) {
                document.querySelector('#custom-input').value = ''
            }
            else {
                const element = document.createElement('li')
                const div = document.createElement('div')
                const text = document.createElement('span')
                text.innerHTML = value
                const closeTag = document.createElement('span')
                closeTag.addEventListener('click', () => element.remove())
                closeTag.innerHTML = 'X'
                div.append(text)
                div.append(closeTag)
                element.append(div)
                document.querySelector('#list').append(element)
            }
            document.querySelector('#custom-input').value = ''
            e.preventDefault()
        }



    }

</script>
{% endblock content %}